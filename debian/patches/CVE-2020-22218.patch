Backport of:

---

From 0b44e558f311671f6e6d14c559bc1c9bda59b8df Mon Sep 17 00:00:00 2001
From: Will Cosgrove <will@panic.com>
Date: Thu, 28 May 2020 14:20:08 -0700
Subject: [PATCH] transport.c: moving total_num check from #476 (#478)

file: transport.c

notes:
moving total_num zero length check from #476 up to the prior bounds check which already includes a total_num check. Makes it slightly more readable.

credit:
Will Cosgrove

---

src/transport.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

Index: libssh2-1.8.0/src/transport.c
===================================================================
--- libssh2-1.8.0.orig/src/transport.c
+++ libssh2-1.8.0/src/transport.c
@@ -462,7 +462,7 @@ int _libssh2_transport_read(LIBSSH2_SESS
              * or less (including length, padding length, payload,
              * padding, and MAC.)."
              */
-            if (total_num > LIBSSH2_PACKET_MAXPAYLOAD) {
+            if (total_num > LIBSSH2_PACKET_MAXPAYLOAD || total_num == 0) {
                 return LIBSSH2_ERROR_OUT_OF_BOUNDARY;
             }
 
